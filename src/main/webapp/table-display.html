<!DOCTYPE html>
<html>
<head lang="zh-cn">
    <meta charset="UTF-8">
    <title>可挂接信息预测与分析系统</title>
    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css"/>
    <link href="css/bootstrap/bootstrap-submenu.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css"/>
    <script src="js/lib/jquery.min.js"></script>
    <script src="js/lib/bootstrap/bootstrap.min.js"></script>
    <script src="js/lib/bootstrap/bootstrap-submenu.min.js"></script>
    <script>
        $(function () {
            $('[data-submenu]').submenupicker(); //二级子菜单
        });
    </script>
    <script src="js/common/page/dataTableGenerator.js"></script>
    <script src="js/common/page/variableSubmit/handler.js"></script>
</head>
<body>
<nav class="navbar navbar-default" role="navigation">
<div class="navbar-header">
    <!--button 这一块的内容，主要是为了当屏幕收缩的时候效果会好点-->
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
            aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="#">MulitInfo</a>
</div>
<div id="navbar" class="navbar-collapse collapse">
<ul class="nav navbar-nav">
<li class="dropdown">
    <a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"
       style="background-color: #337ab7;color: #fff;">
        上传 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li>
            <a>
                <input type="file" name="data_file" id="data_file" data-toggle="tooltip" title="请上传 xls，xlsx 格式的文件"
                       data-placement="top"/>
                <br>
                <button type="submit" class="btn btn-primary" id="file_upload_btn" disabled>上传</button>
            </a>
        </li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" tabindex="0" data-toggle="dropdown" data-submenu aria-expanded="false">
        文件<span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li class="dropdown-submenu">
            <a href="#" tabindex="0">新建</a>
            <ul class="dropdown-menu">
                <li>
                    <a href="#" tabindex="0">数据</a>
                    <a href="#" tabindex="0">语法</a>
                    <a href="#" tabindex="0">输出</a>
                    <a href="#" tabindex="0">脚本</a>
                </li>
            </ul>
        </li>
        <li><a href="#">打开数据库</a></li>
        <li><a href="#">打开文本数据</a></li>
        <li class="divider"></li>
        <li><a href="#">关闭</a></li>
        <li><a href="#">保存</a></li>
        <li><a href="#">另存为</a></li>
        <li class="divider"></li>
        <li><a href="#">退出</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        编辑 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">撤销</a></li>
        <li><a href="#">重新</a></li>
        <li><a href="#">剪切</a></li>
        <li><a href="#">复制</a></li>
        <li><a href="#">粘贴</a></li>
        <li><a href="#">粘贴变量</a></li>
        <li><a href="#">清除</a></li>
        <li class="divider"></li>
        <li><a href="#">插入变量</a></li>
        <li><a href="#">插入个案</a></li>
        <li class="divider"></li>
        <li><a href="#">查找</a></li>
        <li><a href="#">查找下一个</a></li>
        <li><a href="#">替换</a></li>
        <li><a href="#">转至个案</a></li>
        <li><a href="#">转向变量</a></li>
        <li><a href="#">转至归因</a></li>
        <li class="divider"></li>
        <li><a href="#">选项</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        数据 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">定义变量属性</a></li>
        <li><a href="#">设置未知测量级别</a></li>
        <li><a href="#">复制数据属性</a></li>
        <li><a href="#">新建设定属性</a></li>
        <li><a href="#">定义日期</a></li>
        <li><a href="#">定义多重响应集</a></li>
        <li class="divider"></li>
        <li><a href="#">验证</a></li>
        <li><a href="#">识别重复个案</a></li>
        <li><a href="#">识别异常个案</a></li>
        <li><a href="#">比较数据集</a></li>
        <li class="divider"></li>
        <li><a href="#">排序个案</a></li>
        <li><a href="#">排列变量</a></li>
        <li><a href="#">转置</a></li>
        <li><a href="#">合并文件</a></li>
        <li><a href="#">重组</a></li>
        <li><a href="#">分类汇总</a></li>
        <li><a href="#">正交设计</a></li>
        <li class="divider"></li>
        <li><a href="#">复制数据集</a></li>
        <li class="divider"></li>
        <li><a href="#">拆分文件</a></li>
        <li><a href="#">选择个案</a></li>
        <li><a href="#">加权个案</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        转换 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">计算变量</a></li>
        <li><a href="#">对个案内的值计数</a></li>
        <li><a href="#">转换值</a></li>
        <li class="divider"></li>
        <li><a href="#">重新编码为相同变量</a></li>
        <li><a href="#">重新编码为不同变量</a></li>
        <li><a href="#">自动重新编码</a></li>
        <li><a href="#">可视离散化</a></li>
        <li><a href="#">最优离散化</a></li>
        <li><a href="#">准备建模数据</a></li>
        <li class="divider"></li>
        <li><a href="#">个案排秩</a></li>
        <li class="divider"></li>
        <li><a href="#">日期和时间向导</a></li>
        <li><a href="#">创建时间序列</a></li>
        <li><a href="#">替换缺失值</a></li>
        <li><a href="#">随机数字生成器</a></li>
        <li class="divider"></li>
        <li><a href="#">运行挂起的转换</a></li>
    </ul>
</li>
<li class="dropdown">
<a href="#" tabindex="0" data-toggle="dropdown" data-submenu aria-expanded="false">
    分析<span class="caret"></span>
</a>
<ul class="dropdown-menu" style="font-size: 12px;">
<li class="dropdown-submenu">
    <a href="#">报告</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">代码本</a></li>
        <li class="divider"></li>
        <li><a href="#">OLAP立方</a></li>
        <li class="divider"></li>
        <li><a href="#">个案汇总</a></li>
        <li><a href="#">按行汇总</a></li>
        <li><a href="#">按列汇总</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">描述统计</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">频率</a></li>
        <li>
            <a href="#" data-statistic-name="Descriptive Statistics"
               data-modal-url="js/common/nav/Analysis/DescriptiveStatistics/Descriptive/"
               data-modal-name="#Descriptive_Statistics"
               data-modal-script="js/common/nav/Analysis/DescriptiveStatistics/Descriptive/">描述</a>
        </li>
        <li><a href="#">探索</a></li>
        <li><a href="#">交叉表</a></li>
        <li><a href="#">比率</a></li>
        <li><a href="#">P-P图</a></li>
        <li><a href="#">Q-Q图</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">表</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">设定表</a></li>
        <li><a href="#">多响应集</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">比较均值</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">均值</a></li>
        <li><a href="#">单验本T检验</a></li>
        <li><a href="#">独立验本T检验</a></li>
        <li><a href="#">配对验本T检验</a></li>
        <li><a href="#">单因素ANOVA</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">一般线性模型</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">单变量</a></li>
        <li><a href="#">多变量</a></li>
        <li><a href="#">重复度量</a></li>
        <li class="divider"></li>
        <li><a href="#">方差分量估计</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">广义线性模型</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">广义线性模型</a></li>
        <li><a href="#">广义估计方程</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">混合模型</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">线性</a></li>
        <li><a href="#">广义线性</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">相关</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">双变量</a></li>
        <li><a href="#">偏相关</a></li>
        <li><a href="#">距离</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">回归</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">自动线性建模</a></li>
        <li><a href="#">线性</a></li>
        <li><a href="#">曲线估计</a></li>
        <li><a href="#">部分最小平方</a></li>
        <li class="divider"></li>
        <li><a href="#">二元Logistic</a></li>
        <li><a href="#">多项Logistic</a></li>
        <li><a href="#">有序</a></li>
        <li><a href="#">Probit</a></li>
        <li class="divider"></li>
        <li><a href="#">非线性</a></li>
        <li><a href="#">权重估计</a></li>
        <li><a href="#">两阶最小二乘法</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">对数线性模型</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">常规</a></li>
        <li><a href="#">Logit</a></li>
        <li><a href="#">模型选择</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">神经网络</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">多层感知器</a></li>
        <li><a href="#">径向基函数</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">分类</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">两步聚类</a></li>
        <li><a href="#">K-均值聚类</a></li>
        <li><a href="#">系统聚类</a></li>
        <li class="divider"></li>
        <li><a href="#">树</a></li>
        <li><a href="#">判别</a></li>
        <li class="divider"></li>
        <li><a href="#">最近邻元素</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">降维</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">因子分析</a></li>
        <li><a href="#">对应分析</a></li>
        <li><a href="#">最优尺度</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">度量</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">可靠性分析</a></li>
        <li><a href="#">多维展开</a></li>
        <li><a href="#">多维尺度（PROXSCAL）</a></li>
        <li><a href="#">最优尺度（ALSCAL）</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">非参数检验</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">单样本</a></li>
        <li><a href="#">独立样本</a></li>
        <li><a href="#">相关样本</a></li>
        <li><a href="#">旧对话框</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">预测</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">创建模型</a></li>
        <li><a href="#">应用模型</a></li>
        <li class="divider"></li>
        <li><a href="#">季节性分解</a></li>
        <li><a href="#">频谱分析</a></li>
        <li class="divider"></li>
        <li><a href="#">序列图</a></li>
        <li><a href="#">自相关</a></li>
        <li><a href="#">互相关图</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">生存函数</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">寿命表</a></li>
        <li><a href="#">Kaplan-Meier</a></li>
        <li><a href="#">Cox回归</a></li>
        <li><a href="#">Cox依时协变量</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">多重响应</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">定义变量集</a></li>
        <li class="divider"></li>
        <li><a href="#">频率</a></li>
        <li><a href="#">交叉表</a></li>
    </ul>
</li>
<li><a href="#">缺失值分析</a></li>
<li class="dropdown-submenu">
    <a href="#">多重归因</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">分析模式</a></li>
        <li><a href="#">归因缺失数据值</a></li>
    </ul>
</li>
<li class="dropdown-submenu">
    <a href="#">复杂抽样</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">选择样本</a></li>
        <li class="divider"></li>
        <li><a href="#">准备分析</a></li>
        <li class="divider"></li>
        <li><a href="#">频率</a></li>
        <li><a href="#">描述</a></li>
        <li><a href="#">交叉表</a></li>
        <li><a href="#">比率</a></li>
        <li class="divider"></li>
        <li><a href="#">一般线性模型</a></li>
        <li><a href="#">Logistic回归</a></li>
        <li><a href="#">序列回归</a></li>
        <li><a href="#">Cox回归</a></li>
    </ul>
</li>
<li><a href="#">模拟</a></li>
<li class="dropdown-submenu">
    <a href="#">质量控制</a>
    <ul class="dropdown-menu" style="font-size: 12px;">
        <li><a href="#">控制图</a></li>
        <li><a href="#">排列图</a></li>
    </ul>
</li>
<li><a href="#">ROC曲线图</a></li>
</ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        <!--style="background-color: #337ab7;color: #fff;">-->
        丁氏图 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">1</a></li>
        <li><a href="#">2</a></li>
        <li><a href="#">3</a></li>
        <li class="divider"></li>
        <li><a href="#">5</a></li>
        <li><a href="#">6</a></li>
        <li><a href="#">7</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        图形 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">条形图</a></li>
        <li><a href="#">3-D条形图</a></li>
        <li><a href="#">线图</a></li>
        <li><a href="#">面积图</a></li>
        <li><a href="#">饼图</a></li>
        <li><a href="#">高低图</a></li>
        <li class="divider"></li>
        <li><a href="#">箱图</a></li>
        <li><a href="#">误差条形图</a></li>
        <li><a href="#">人口金字塔</a></li>
        <li class="divider"></li>
        <li><a href="#">另一个分离的链接</a></li>
        <li><a href="#">散点/点状</a></li>
        <li><a href="#">直方图</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        应用程序 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">变量</a></li>
        <li><a href="#">OMS控制面板</a></li>
        <li><a href="#">OMS标识符</a></li>
        <li class="divider"></li>
        <li><a href="#">评分向导</a></li>
        <li><a href="#">合并模型XML</a></li>
        <li class="divider"></li>
        <li><a href="#">定义变量集</a></li>
        <li><a href="#">使用变量集</a></li>
        <li><a href="#">显示所有变量</a></li>
        <li class="divider"></li>
        <li><a href="#">拼写</a></li>
        <li class="divider"></li>
        <li><a href="#">运行脚本</a></li>
        <li class="divider"></li>
        <li><a href="#">生产设施</a></li>
        <li><a href="#">地图转换实用程序</a></li>
        <li class="divider"></li>
        <li><a href="#">定制对话框</a></li>
        <li><a href="#">扩展束</a></li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        窗口<span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">拆分</a></li>
        <li><a href="#">将所有窗口最小化</a></li>
        <li><a href="#">重置对话框和位置</a></li>
        <li class="divider"></li>
        <li>
            <a href="#">
                <div class="checkbox">
                    <label>
                        <input type="checkbox"> 数据编辑器
                    </label>
                </div>
            </a>
        </li>
    </ul>
</li>
<li class="dropdown">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
        帮助 <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">主题</a></li>
        <li><a href="#">教程</a></li>
        <li><a href="#">个案研究</a></li>
        <li><a href="#">使用R</a></li>
        <li><a href="#">统计辅导</a></li>
        <li><a href="#">指令语法参考</a></li>
        <li><a href="#">关于</a></li>
        <li><a href="#">算法</a></li>
        <li><a href="#">产品主页</a></li>
        <li><a href="#">可编程性</a></li>
    </ul>
</li>
</ul>
</div>
</nav>

<div class="container-fluid">
    <div class="row data-present-area">
        <h1 id="title" class="col-md-10 col-md-offset-1"></h1>

        <div class="col-md-10 col-md-offset-1">
            <ul class="nav nav-tabs"></ul>
        </div>

        <div class="col-md-10 col-md-offset-1 table-present custom-scrollbar-grey"></div>

        <div class="col-md-10 col-md-offset-1 text-right">
            <button class="btn btn-primary">下一步</button>
        </div>
    </div>
</div>

<script>
    var variableList, dataGrid;
    $(document).ready(function () {
        $.ajax({
//            url: 'upload.do?method=file&isFirstRowVar=true',
            url: 'js/testJSON/excel_callback.json',
            data: {
                'isMultiSheet': sessionStorage.getItem('isMultiSheet'),
                'token': sessionStorage.getItem('token'),
                'sheetNo': sessionStorage.getItem('sheetNo')
            },
            type: 'GET',
            dataType: 'JSON',
            success: function (data) {
                dataTableGenerator(data);
                variableList = data.sheet.variety;
                dataGrid = data.sheet.dataGrid;
            }
        })
    }).on('click', '.variable-wrapper', function (e) {
        e.preventDefault();
        $(this).toggleClass('active');
    }).on('click', '.variable-submit', function (e) {
        e.preventDefault();
        handleSubmitType($(this).attr('data-btn-type'), dataGrid);
    }).on('click','.variable-config', function (e) {
        e.preventDefault();
        $('[data-panel="config"]').toggle();
    });

    $('.dropdown-submenu .dropdown-menu a').click(function (e) {
        e.preventDefault();
        var componentUrl = $(this).attr('data-modal-url') + 'modal.html';
        var componentScript = $(this).attr('data-modal-script') + 'script.js';
        var componentName = $(this).attr('data-modal-name');

        $.get(componentUrl, function (modalHTML) {
            $('body').append(modalHTML);
            $(componentName).modal({'show': true});
        });

        $.getScript(componentScript, function () {
            descriptiveStatisticsVariableChoose(variableList);
        });

    });
</script>
</body>
</html>