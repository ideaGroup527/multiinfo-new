<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>丁氏图</title>
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
        }

        #canvas {
            display: block;
            margin: 100px auto;
        }
    </style>
</head>
<body>
<canvas id="canvas" width="1200" height="1200"></canvas>
<script>
    var data = {
        "ret_code": "0",
        "ret_msg": "",
        "ret_err": "",
        "resData": [[0, 0.00018005826730264882, 0.000019571550793766163, 0.0029674944500673824, 0.0001789398929715765, 0.00026449552929861157, 0.00023765454535287507, 0.017461737618198192, 0.00024604235283591774, 0.04071441752268903], [0.00008164132616828174, 0.0002275891763732239, 0.00012917223523885684, 0.002980691267174036, 0.000345018481135821, 0.0003891942672131789, 0.0003466960426324295, 0.020684333253183175, 0.0002829487057613054, 0.045523427146300144], [0.00008611482349257115, 0.00038416158272335335, 0.0002527525988223518, 0.00309621933557381, 0.0004999133259893419, 0.0005440891120666998, 0.00046412534739502656, 0.020902416247742285, 0.00045629672707752007, 0.05105938008510829], [0.0002510750373257433, 0.0006061588874412154, 0.0004618885987328819, 0.00316499935693476, 0.0007515475504806214, 0.0005435299249011637, 0.0007381270585077532, 0.02592391699425715, 0.0003466960426324295, 0.06341741644345779], [0.00032992042766634427, 0.0008661809194155377, 0.0006218161280762284, 0.003629124704329786, 0.0007543434863083023, 0.0005043868233136315, 0.0008331888766489032, 0.028686301592005862, 0.0005765219676677982, 0.07314727312378726], [0.00044399460943572424, 0.0009193037001414743, 0.0007694415397777791, 0.003685043420883404, 0.0005759627805022618, 0.0006576041066705437, 0.0009170669514793296, 0.03182893346231918, 0.0005547136682118873, 0.07739709558186221], [0.0005032684489825589, 0.0010551861813667652, 0.00096236111188776, 0.0034166335814260393, 0.0007179963205484507, 0.0009282506947900533, 0.0010792312294848208, 0.032494366189307226, 0.000443435422270188, 0.08064038114197203], [0.0005261951227695422, 0.0014063557213234842, 0.0012235015181931547, 0.0036235328326744247, 0.0008331888766489032, 0.0013811922988743565, 0.0013029060956992917, 0.03255028490586084, 0.0003271244918386633, 0.09092942498783768], [0.0006676694756501949, 0.0020477434001934794, 0.0015970385447713206, 0.004059698821792642, 0.00084828693011838, 0.001970575571349487, 0.0015981569191023928, 0.035088994637395086, 0.00028909976458220334, 0.1182177586660031], [0.0011759706091225796, 0.0026214694320335964, 0.0022009606835503913, 0.0047586827787128635, 0.0009774591653572366, 0.0023944394428259083, 0.002130503100692833, 0.04798385067465932, 0.00026561390362968393, 0.14964407736913624], [0.0014824051758364043, 0.0036777739877314336, 0.0031426318703133126, 0.006313223098903434, 0.0010635180701332543, 0.002978790030811213, 0.0027008740095397334, 0.05535114158059845, 0.0002734425239471903, 0.18559981211311238], [0.0019224854751133755, 0.00400601685390117, 0.003924934714898424, 0.007437189301631149, 0.00129731422404393, 0.003534062886188636, 0.0031761831002454837, 0.07766550542131957, 0.00027288333678165413, 0.20813505488422032], [0.0020113962344336274, 0.004460636019482081, 0.0045937225648796905, 0.008275970049935414, 0.0015377647052244859, 0.004302386051635343, 0.0034837360412903807, 0.08407938221001952, 0.00025554853465003277, 0.2245751575509839], [0.002228360854661664, 0.004820752554087379, 0.005182546650189285, 0.008919035290302017, 0.0016719696249531681, 0.005474442350599169, 0.0038192483406120866, 0.09574961835475952, 0.00023374023519412182, 0.23827524310662027], [0.00219089531457074, 0.005307804575269388, 0.005802685216768905, 0.009919980316611775, 0.0021696462022803655, 0.006665511013191225, 0.004126801281656984, 0.0975949360010289, 0.0001912420106133724, 0.24962674256700465], [0.0020762619456358242, 0.006292533173778596, 0.006635314906252272, 0.010976844059475147, 0.0024156885551162833, 0.008309521279867584, 0.004546191655809116, 0.09592296637607574, 0.00016887452399192533, 0.2700929928256287], [0.0022798060738909924, 0.007101117815143906, 0.00799581728000179, 0.01199456470075099, 0.002376545453528751, 0.010188390156069139, 0.00503268448982559, 0.10144773557157316, 0.00015713159351566568, 0.29810826981899113], [0.0024632194641868582, 0.008061242178369522, 0.009072252573658929, 0.012973142240439299, 0.0024883828866359863, 0.012195872080344013, 0.005368196789147296, 0.10672087054257931, 0.000148743786032623, 0.32405455429986973], [0.002613081624550554, 0.010365652487544107, 0.010432195760242912, 0.013174449620032322, 0.0023541779669073036, 0.017284475286723222, 0.006254508446522136, 0.11376103695667977, 0.00011463336893491616, 0.3736544558829286], [0.003272363292717706, 0.013149286197583194, 0.012119822625831092, 0.013062612186925086, 0.0028238951859576923, 0.02053894459014377, 0.008085846413653114, 0.12923933769872115, 0.00012749467374224824, 0.5138426782828481], [0.0035329445118575642, 0.015228344079046701, 0.013638015780261812, 0.01377277988715603, 0.0029916513356185452, 0.024291090470891515, 0.009248955717968362, 0.13979679138404416, 0.00011631093043152474, 0.5720540622151641], [0.003950098137347552, 0.01906436803462487, 0.015237291073695279, 0.015036542881267793, 0.0032768367900419954, 0.027388987367961932, 0.010630148016842717, 0.1538435729823129, 0.00010009450263097557, 0.6619713584333813], [0.0049762065861064355, 0.024767517935928338, 0.018486168505460466, 0.015808221169707717, 0.003584389731086892, 0.03304236961153268, 0.012548159994631804, 0.17736857703641987, 0.000048090096236111164, 0.818655602216618], [0.00621872046792782, 0.03200451823229754, 0.021711000889107598, 0.01756406886949131, 0.0044214929178945485, 0.04751692939143661, 0.01544754544793688, 0.2053614865431609, 0.000044175786077357906, 1]],
        "rowVarList": [{
            "position": "2",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1985.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "3",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1986.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "4",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1987.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "5",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1988.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "6",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1989.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "7",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1990.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "8",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1991.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "9",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1992.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "10",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1993.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "11",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1994.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "12",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1995.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "13",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1996.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "14",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1997.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "15",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1998.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "16",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "1999.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "17",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2000.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "18",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2001.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "19",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2002.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "20",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2003.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "21",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2004.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "22",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2005.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "23",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2006.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "24",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2007.0",
            "varietyDes": null,
            "range": null
        }, {
            "position": "25",
            "typeDes": null,
            "type": null,
            "typeFormat": null,
            "varietyName": "2008.0",
            "varietyDes": null,
            "range": null
        }],
        "colVarList": [{
            "position": "B",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "一产增加值(亿元)",
            "varietyDes": null,
            "range": "B2:B25"
        }, {
            "position": "C",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "二产增加值(亿元)",
            "varietyDes": null,
            "range": "C2:C25"
        }, {
            "position": "D",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "三产增加值(亿元)",
            "varietyDes": null,
            "range": "D2:D25"
        }, {
            "position": "E",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "货物周转量（亿吨、公里）",
            "varietyDes": null,
            "range": "E2:E25"
        }, {
            "position": "F",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "旅客周转量（百万、人、公里）",
            "varietyDes": null,
            "range": "F2:F25"
        }, {
            "position": "G",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "固定资产投资总额(亿元)",
            "varietyDes": null,
            "range": "G2:G25"
        }, {
            "position": "H",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "消费品零售总额(亿元)",
            "varietyDes": null,
            "range": "H2:H25"
        }, {
            "position": "I",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "农民年人均收入（元）",
            "varietyDes": null,
            "range": "I2:I25"
        }, {
            "position": "J",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "人口自然增长率‰",
            "varietyDes": null,
            "range": "J2:J25"
        }, {
            "position": "K",
            "typeDes": "字符串型",
            "type": 0,
            "typeFormat": null,
            "varietyName": "人均GDP（元）",
            "varietyDes": null,
            "range": "K2:K25"
        }]
    }
</script>
<script>
    var canvas = document.getElementById('canvas');
    var ctx = canvas.getContext('2d');
    var width = canvas.width,
            height = canvas.height;
    ctx.lineWidth = 1;
    ctx.strokeStyle = "#aaa";
    ctx.textAlign = 'center';
    //行数和列数
    var col = data.colVarList.length + 1,
            row = data.rowVarList.length + 1;
    //椭圆长半轴和短半轴
    var a = width / col / 2, b = height / row / 2;

    //横线
    for (var i = 0; i < row; i++) {
        var y = i * (height / row);
        ctx.beginPath();
        ctx.moveTo(width / col, y);
        ctx.lineTo(width, y);
        ctx.stroke();
    }
    //y轴
    for (var i = 0; i < (row - 1); i++) {
        var y = i * (height / row);

        ctx.fillText(data.rowVarList[i].varietyName, 50, y + height / row / 2);
    }


    //纵线
    for (var i = 1; i <= col; i++) {
        var x = i * width / col;
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, height - height / row);
        ctx.stroke();
    }
    //x轴
    for (var i = 0; i < col - 1; i++) {
        var x = i * width / col;
        ctx.fillText(data.colVarList[i].varietyName, x + (width / col) * 3 / 2, height - 10);
    }

    //椭圆
    for (var i = 0; i < col - 1; i++) {
        for (var j = 0; j < row - 1; j++) {
            EllipseTwo(ctx, (i + 1) * (width / col) + a, j * (height / row) + b, a * data.resData[j][i], b);
        }
    }


    function EllipseTwo(context, x, y, a, b) {
        context.save();
        context.fillStyle = "#980707";
        var r = (a > b) ? a : b;
        var ratioX = a / r;
        var ratioY = b / r;
        context.scale(ratioX, ratioY);
        context.beginPath();
        context.arc(x / ratioX, y / ratioY, r, 0, 2 * Math.PI, false);
        context.closePath();
        context.fill();
        context.restore();
    }
</script>
</body>
</html>